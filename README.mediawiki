== AddSpectrum2Pic - программа для добавления спектра на картинку ==

=== Назначение ===
Программа была написана для личного пользования при подготовке магистерского диплома, чтобы улучшить внешний вид и информативность графиков как в тексте, так и на презентации.

Она позволяет добавить либо изображение спектра монохроматического излучения в заданном диапазоне длин волн, либо цвета излучения абсолютно черного тела в заданном диапазоне температур или по какой-либо другой величине (показатель цвета, спектральный класс и др), если задана таблица соответствия температуры этой величине.

Примеры изображений приведены ниже, для увеличения картинки щелкните по ней.

{|
| [[File:images/sample1.gif]]
Кривая излучения абсолютно черного тела при 3500K, спектральная чувствительность глаза и матрицы Star 250, кривая пропускания светофильтра: Добавлен спектр монохроматического излучения

| [[File:images/sample4.gif]]
Поправка к чувствительности матрицы, в зависимости от температуры источника. Добавлен цвет абсолютно черного тела при разных температурах, в логарифмическом масштабе

|-

| [[File:images/sample3.gif]]
Поправка к звездной величине в зависимости от спектрального класса. Добавлен цвет, соотв. спектральному классу, с использованием таблицы main_sequence.txt (соответствие спектральных классов температуре поверхности звезды)

| [[File:images/sample2.gif]]
Поправка к звездной величине в зависимости от показателя цвета. Здесь использовалась таблица T_vs_CI.txt (соответствие индекса цвета звездного каталога Tycho2 температуре поверхности звезды).

|}

=== Как пользоваться программой ===

# Загружаем картинку, нажав соответствующую кнопку. В версии 0.02 поддерживаются почти все графические форматы.

Если нужно добавить картинку на график в Excel или в Word, можно выделить его и скопировать в буфер обмена - он загрузится в виде картинки.

Чтобы извлечь картинку из форматов pdf или djvu, есть универсальный,хотя и "топорный" метод - открыть требуемую картинку почти на весь экран, нажать Print Screen, открыть Paint, нажать Ctrl-V, выделить нужную часть изображения и снова нажать ctrl-C, а затем в программе нажать кнопку "из буфера обмена". 

# Выбираем, что нам нужно построить: спектр монохроматического излучения или цвета абсолютно черного тела.

# В случае монохроматического спектра задаем минимальную и максимальную длину волны, изображенные на графике. Если график в логарифмическом масштабе, ставим галочку "Лог."

Если график цвета А.Ч.Т. и по оси X отмечена температура, то вводим мин. и макс. температуры, ставим, если надо, логарифмический масштаб. 

# Если по оси X отмечена какая-другая величина, программе требуется таблица соответствия между указанной величиной и температурой. Эта таблица имеет простой текстовый вид: на каждой строке располагается пара чисел, разделенная пробелом, табом, запятой или точкой с запятой. Разрешается писать строки комментариев, начинающиеся с //. Они программой игнорируются. В папке приведены таблицы main_sequence (соответствие температур спектральным классам) и T_vs_CI.

# После того, как таблица загружена, требуется указать минимальное и максимальное значение величины в соответствующих полях. В случае спектрального класса, надо посмотреть файл main_sequence.txt, там указано, каким числом отмечен каждый класс. 

# Отмечаем на графике прямоугольник, в котором будет располагаться спектр. Сначала щелкаем по верхней левой точке, потом по нижней правой. Если одну из точек надо подправить, нажимаем по одной из двух кнопок слева (начало полосы/конец полосы) и щелкаем еще раз.

# На графике должен появиться прямоугольник с заданным спектром. Теперь надо настроить его вид. Для монохроматического излучения полезно отрегулировать параметр "забеление". Он определяет, как быть с отрицательными значениями R,G,B. При забелении 0, они просто "округляются" до нуля, при этом, хотя спектр получается очень ярким, у него возникают области, где цвет вообще не меняется. Это связано с тем, что смешивая три цвета - красный, зеленый и синий - нельзя получить любой существующий цвет. Особенно это касается монохроматических зеленых. Однако, можно сделать цвет менее насыщенным - к монохроматическому излучению прибавить белый. Тогда цветов станет существенно больше, хотя итоговый спектр станет не таким ярким, а его крайние полосы из черных станут серыми. Забелению 1 соответствует прибавление такого уровня белого, чтобы отрицательных коэффициентов совсем не осталось. Автору кажется хорошим компромиссом значение 0.1..0.2.

После каждого изменения надо нажать кнопку "обновить", чтобы изменения отобразились на экране.

Для цвета абсолютно черного тела необходимо выставить параметр "насыщенность" на уровень 0.000001 (еще десяток нулей не помешает). Дело в том, что изначально эти цвета отнормированы по яркости в соответствии с законам Стефана-Больцмана, согласно которому мощность излучения растет как четвертая степень температуры. Иногда такая нормировка полезна. Если, к примеру, мы поставим температуры от 300K (комнатная) до 2700K (нить накаливания в лампочке), мы получим, как будет выглядить нить накала при ее плавном разогреве до рабочей температуры. Чаще, однако, такая нормировка только вредит: лишь на самой высокой температуре будет виден цвет, все остальное по контрасту окажется черным. Чтобы это исправить, и введена "насыщенность". Этот параметр указывает, свыше какой доли от максимальной яркости ее надо выставлять на постоянный уровень. 

# Получив, наконец, спектр нужного вида, остается сохранить изображение кнопкой "Сохранить".

Приятного пользования!